<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Laporan Keuangan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      transition: background 0.3s, color 0.3s;
    }
    .card {
      transition: background 0.3s, color 0.3s;
    }
    [data-bs-theme=dark] body {
      background: #121212 !important;
    }
  </style>
</head>
<body class="bg-light">

<div class="container py-4">
  <h1 class="text-center mb-4">ðŸ“Š Laporan Keuangan</h1>

  <!-- Form input -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="row g-2">
        <div class="col-md-2">
          <input type="date" id="date" class="form-control">
        </div>
        <div class="col-md-3">
          <input type="text" id="desc" class="form-control" placeholder="Keterangan">
        </div>
        <div class="col-md-2">
          <input type="number" id="amount" class="form-control" placeholder="Jumlah (Rp)">
        </div>
        <div class="col-md-2">
          <select id="type" class="form-select">
            <option value="Pemasukan">Pemasukan</option>
            <option value="Pengeluaran">Pengeluaran</option>
          </select>
        </div>
        <div class="col-md-3">
          <button class="btn btn-primary w-100" onclick="addTransaction()">Tambah Transaksi</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabel transaksi -->
  <div class="card shadow-sm">
    <div class="card-body">
      <table id="transactionTable" class="table table-bordered">
        <thead class="table-dark">
          <tr>
            <th>Tanggal</th>
            <th>Keterangan</th>
            <th>Pemasukan</th>
            <th>Pengeluaran</th>
            <th>Saldo</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<!-- Script taruh paling bawah -->
<script>
  let transactions = [];
  let filteredTransactions = [];

  // Tambah transaksi
  function addTransaction() {
    let date = document.getElementById("date").value;
    let desc = document.getElementById("desc").value;
    let amount = parseFloat(document.getElementById("amount").value);
    let type = document.getElementById("type").value;

    if (!date || !desc || isNaN(amount)) {
      alert("Lengkapi semua field!");
      return;
    }

    transactions.push({ date, desc, amount, type });
    filteredTransactions = [...transactions];
    renderTable();

    // reset input
    document.getElementById("date").value = "";
    document.getElementById("desc").value = "";
    document.getElementById("amount").value = "";
    document.getElementById("type").value = "Pemasukan";
  }

  // Render tabel
  function renderTable() {
    const tbody = document.querySelector("#transactionTable tbody");
    tbody.innerHTML = "";
    let balance = 0;

    filteredTransactions.forEach((t, index) => {
      if (t.type === "Pemasukan") balance += t.amount;
      else balance -= t.amount;

      let row = document.createElement("tr");
      row.innerHTML = `
        <td></td>
        <td></td>
        <td class="text-success"> "-"</td>
        <td class="text-danger"> "-"</td>
        <td><b></b></td>
        <td>
          <button class="btn btn-sm btn-danger" onclick="deleteTransaction()">Hapus</button>
        </td>
      `;
      tbody.appendChild(row);
    });
  }

  // Hapus transaksi
  function deleteTransaction(index) {
    transactions.splice(index, 1);
    filteredTransactions = [...transactions];
    renderTable();
  }

  // Format angka jadi Rupiah
  function formatRupiah(num) {
    return "Rp " + num.toLocaleString("id-ID");
  }

  // Deteksi mode gelap/terang otomatis
  function setTheme() {
    if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
      document.documentElement.setAttribute("data-bs-theme", "dark");
      document.body.classList.remove("bg-light");
      document.body.classList.add("bg-dark", "text-white");
    } else {
      document.documentElement.setAttribute("data-bs-theme", "light");
      document.body.classList.remove("bg-dark", "text-white");
      document.body.classList.add("bg-light");
    }
  }
  setTheme();
  window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", setTheme);
</script>
</body>
</html>
